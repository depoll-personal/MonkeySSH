#!/bin/bash
# Pre-commit hook for Flutty
# Install: cp scripts/pre-commit .git/hooks/pre-commit && chmod +x .git/hooks/pre-commit

set -e

echo "Running pre-commit checks..."

# Check if there are any staged Dart files
STAGED_DART_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep '\.dart$' || true)

if [ -n "$STAGED_DART_FILES" ]; then
    echo "Checking formatting..."
    dart format --set-exit-if-changed $STAGED_DART_FILES
    
    echo "Running analyzer..."
    flutter analyze --fatal-infos --no-pub
    
    echo "Running tests..."
    flutter test --no-pub
fi

echo "Pre-commit checks passed!"
